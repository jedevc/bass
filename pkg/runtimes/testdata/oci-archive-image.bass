(def go-archive
  (subpath
    (from (linux/alpine)
      ($ apk add skopeo)
      ($ skopeo copy "docker://golang:1.19-alpine" "oci-archive:image.tar:latest"))
    ./image.tar))

(def go-image
  (oci-load go-archive {:os "linux"} :tag "latest"))

(run (from go-image
       ($ go env GOPATH)))

; test that both $PATH and $GOPATH from image config are respected
(assert = "/go"
  (-> (from go-image
        ($ go env GOPATH))
      (read :lines)
      next))
